
# ibio-851 notes for 9-14-2017

Today: advanced stuff.

## Making Functions

An example:
```
cv <- function(xvec) {
  cv.value <- sd(xvec)/mean(xvec)
  return(cv.value)
}

values <- rnorm(n=1000, mean=5, sd=2)
cv(values)

```

Some built-in functions have lots of optional argumens.
To add optional arguments:
```
CVnew <- function(xvec, na.rm=F) {
  cv.value <- sd(svec, na.rm=na.rm)/mean(xvec, na.rm=na.rm)
  return(cv.value)
}
```

Well-designed functions only receive inputs through their arguments.

Print the arguments for a function using `args()`.
Print the source of a function by just calling it without parens.
You can edit the source of a function and save it as a new function by `edit()`.

The function `return()` spits out a result from the function.
Often, though, we need to return may values from a funciton.
We can return a list (even with contents named).
```
return(
    list(ave=ave, var=var, sd=sqrt(var))
  )
```

Objects in functions? What gives?
Objects encapsulated within the `cv` namespace are not available outside it.
The scope of an object is where it is "visible."
Functions see global objects.
```
x1 <- 10
myf <- function(foo) {
  # can use x1 here
}
```
R will not overwrite a global variable from within a function, though.
If there is a local variable and a global variable with the same name, R wil use the local variable.

**Avoid using global variables in functions.**

## Looping

Syntax:
```
for (i in 1:100) {
  print(i)
}

for (i in unique(iris$Species)) {
  meanSepalLength <- mean(iris[iris$Species==i,]$Petal.Length)
  cat(i, meanSepalLength, meanPetalLength, "\n")
```

Common way to use loops: populate an empty vector.

If statements, if/else statements, and while loops are also avaialable in R.

## Make your code fast

Avoid printing to screen and writing to file.

Use vectorized code where possible.

Apply functions across data. Use the `apply` functions.

## Coding best practices

Verify! Use tests or print out intermediate results to check your work.

Comment at the top of your script. Describe the purpose of the code, your name, the date that you started writing the code.

Comment before each function or section of code.

Comment throughout.

Name your code. Make it informative! If files need to be run in sequence, prefix them with numbers.

Meaningful object names should be not too short and not too long.
Objects in R are global so use unique names

Indent your code inside brackets.
Indent if a statement goes over multiple lines.
